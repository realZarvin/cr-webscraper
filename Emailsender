#Start of sending Emails


SMTP_SERVER = 'smtp.gmail.com'#Email Configuration 
SMTP_PORT = 587 
EMAIL = 'midasscanner@gmail.com'  # Sending Email, Var?
PASSWORD = 'Melo2006.'  # Password


# Email list accumulated in Phase O
email_list = pd.read_csv('emails.csv')


# Email;
subject = "Invitation to List Your Project on Our Leading CEX"

body_template = """
Dear {recipient},

I hope this message finds you well.

My name is Zarvin, and I am a Community Manager at BitMart. I am writing to extend a special invitation for you to list your project on our Centralized Exchange (CEX).

At Bitmart, we are committed to providing a premier trading platform that offers extensive benefits to our listed projects, including:
- Increased Visibility: Gain exposure to a global audience of enthusiastic traders and investors.
- Robust Security: Our state-of-the-art security measures ensure the safety and integrity of your assets.
- Liquidity Support: Access deep liquidity pools to facilitate seamless trading experiences for your users.
- Dedicated Support: Benefit from our dedicated support team, ready to assist you at every step.

We are confident that your project will thrive on our platform, reaching new heights and attracting a broader community of supporters. 

If you are interested in exploring this opportunity, please reply to this email. I would be delighted to provide you with further details and assist you with the listing process.

Thank you for considering our invitation. We look forward to the possibility of collaborating with you.

Best regards,

Zarvin
Community Manager
BitMart
zarvinns@gmail.com
"""


# Email Sender?
def send_email(to_email, subject, body):
    msg = MIMEMultipart()
    msg['From'] = EMAIL
    msg['To'] = to_email
    msg['Subject'] = subject
    
    msg.attach(MIMEText(body, 'plain'))
    
    try:
        with smtplib.SMTP(SMTP_SERVER, SMTP_PORT) as server:
            server.starttls()
            server.login(EMAIL, PASSWORD)
            server.sendmail(EMAIL, to_email, msg.as_string())
            print('Email sent to {}'.format(to_email))
    except Exception as e:
        print('Failed to send email to {}: {}'.format(to_email, e))


# Send emails_1
for index, row in email_list.iterrows():
    recipient_email = row['email']
    body = body_template.format(recipient=recipient_email)
    send_email(recipient_email, subject, body)


# Send emails_2
def send_email(to_email, subject, body):
    msg = MIMEMultipart()
    msg['From'] = EMAIL
    msg['To'] = to_email
    msg['Subject'] = subject
    
    msg.attach(MIMEText(body, 'plain'))
    
    try:
        with smtplib.SMTP(SMTP_SERVER, SMTP_PORT) as server:
            server.starttls()
            server.login(EMAIL, PASSWORD)
            server.sendmail(EMAIL, to_email, msg.as_string())
            print('Email sent to {}'.format(to_email))
    except Exception as e:
        print('Failed to send email to {}: {}'.format(to_email, e))


# Send emails_3
for index, row in email_list.iterrows():
    recipient_email = row['email']
    body = body_template.format(recipient=recipient_email)
    send_email(recipient_email, subject, body)

#End of Program!
